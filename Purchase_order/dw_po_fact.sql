CREATE SCHEMA if not exists dw;

DROP TABLE if exists dw.po_fact;

CREATE TABLE dw.po_fact 
(
  PO_KEY                        BIGINT IDENTITY(0,1),
  DOCUMENT_NUMBER              VARCHAR(500),
  PO_NUMBER                    VARCHAR(150),
  PO_ID                        INTEGER,         
  PO_LINE_ID                   INTEGER,        
  REF_TRX_NUMBER               VARCHAR(200),   
  REF_TRX_TYPE_KEY              INTEGER,   
  VENDOR_KEY                    INTEGER,
  REQUESTER_KEY                 INTEGER,
  APPROVER_LEVEL1_KEY           INTEGER,
  APPROVER_LEVEL2_KEY           INTEGER,
  RECEIVE_DATE_KEY              INTEGER,
  CREATE_DATE_KEY               INTEGER,
  TRANSACTION_DATE_KEY          INTEGER,
  SUBSIDIARY_KEY                INTEGER,
  LOCATION_KEY                  INTEGER,
  COST_CENTER_KEY               INTEGER,
  EXCHANGE_RATE                 DECIMAL(30,15),
  ITEM_KEY                      INTEGER,
  BILL_ADDRESS_LINE_1          VARCHAR(500),       
  BILL_ADDRESS_LINE_2          VARCHAR(500),       
  BILL_ADDRESS_LINE_3          VARCHAR(500),       
  BILL_CITY                    VARCHAR(200),       
  BILL_COUNTRY                 VARCHAR(200),      
  BILL_STATE                   VARCHAR(200),       
  BILL_ZIP                     VARCHAR(200),      
  SHIP_ADDRESS_LINE_1          VARCHAR(500),       
  SHIP_ADDRESS_LINE_2          VARCHAR(500),       
  SHIP_ADDRESS_LINE_3          VARCHAR(500),       
  SHIP_CITY                    VARCHAR(200),      
  SHIP_COUNTRY                 VARCHAR(200),      
  SHIP_STATE                   VARCHAR(200),      
  SHIP_ZIP                     VARCHAR(200),     
  QUANTITY                      DECIMAL(18,8),
  BIH_QUANTITY                  DECIMAL(22),
  BC_QUANTITY                   DECIMAL(22),
  TRADE_QUANTITY                DECIMAL(22),
  NZSO_QUANTITY                 DECIMAL(22),
  EDUCATION_QUANTITY            DECIMAL(22),
  SCHOOL_ESSENTIALS_QUANTITY    DECIMAL(22),
  BOOK_FAIR_QUANTITY            DECIMAL(22),
  NUMBER_BILLED                DECIMAL(18,8),          
  QUANTITY_RECEIVED_IN_SHIPMENT DECIMAL(18,8),         
  QUANTITY_RETURNED            DECIMAL(22,8),          
  RATE                          VARCHAR(50),
  AMOUNT                        DECIMAL(20,2),
  ITEM_GROSS_AMOUNT             DECIMAL(20,2),
  AMOUNT_FOREIGN                DECIMAL(22,2),
  NET_AMOUNT                    DECIMAL(22,2),
  NET_AMOUNT_FOREIGN            DECIMAL(22,2),
  GROSS_AMOUNT                  DECIMAL(22,2),
  MATCH_BILL_TO_RECEIPT         VARCHAR(10),
  TRACK_LANDED_COST             VARCHAR(10),
  TAX_ITEM_KEY                  INTEGER,
  TAX_AMOUNT                    DECIMAL(20,2),
  REQUESTED_RECEIPT_DATE_KEY    INTEGER,
  ACTUAL_DELIVERY_DATE_KEY      INTEGER,
  FREIGHT_ESTIMATE_METHOD_KEY   INTEGER,
  FREIGHT_RATE                  DECIMAL(22),
  CARRIER_KEY                   INTEGER,
  TERMS_KEY                     INTEGER,
  PO_TYPE_KEY                   INTEGER,
  PO_STATUS_KEY                 INTEGER,
  APPROVAL_STATUS               VARCHAR(4000),
  DATE_ACTIVE_FROM              DATE,
  DATE_ACTIVE_TO                DATE,
  DW_CURRENT                    INTEGER,
  CURRENCY_KEY                  INTEGER,
  CLASS_KEY                     INTEGER,
  PRIMARY KEY (PO_KEY),
  FOREIGN KEY(TERMS_KEY) REFERENCES DW.PAYMENT_TERMS (PAYMENT_TERM_KEY),
  FOREIGN KEY(VENDOR_KEY) REFERENCES DW.VENDORS (VENDOR_KEY),
  FOREIGN KEY(REQUESTER_KEY) REFERENCES DW.EMPLOYEES ( EMPLOYEE_KEY),
  FOREIGN KEY(APPROVER_LEVEL1_KEY) REFERENCES DW.EMPLOYEES ( EMPLOYEE_KEY),
  FOREIGN KEY(APPROVER_LEVEL2_KEY) REFERENCES DW.EMPLOYEES ( EMPLOYEE_KEY),
  FOREIGN KEY(RECEIVE_DATE_KEY) REFERENCES DW.DWDATE (DATE_KEY),
  FOREIGN KEY(CREATE_DATE_KEY) REFERENCES DW.DWDATE (DATE_KEY),
  FOREIGN KEY(TRANSACTION_DATE_KEY) REFERENCES DW.DWDATE (DATE_KEY),
  FOREIGN KEY(SUBSIDIARY_KEY) REFERENCES DW.SUBSIDIARIES  (SUBSIDIARY_KEY),
  FOREIGN KEY(LOCATION_KEY) REFERENCES DW.LOCATIONS (LOCATION_KEY),
  FOREIGN KEY(CLASS_KEY) REFERENCES DW.CLASSES (CLASS_KEY),
  FOREIGN KEY(COST_CENTER_KEY) REFERENCES DW.cost_center(DEPARTMENT_KEY),
  FOREIGN KEY(ITEM_KEY) REFERENCES DW.ITEMS (ITEM_KEY),
  FOREIGN KEY(TAX_ITEM_KEY) REFERENCES DW.TAX_ITEMS (TAX_ITEM_KEY),
  FOREIGN KEY(REQUESTED_RECEIPT_DATE_KEY) REFERENCES DW.DWDATE (DATE_KEY),
  FOREIGN KEY(ACTUAL_DELIVERY_DATE_KEY) REFERENCES DW.DWDATE (DATE_KEY),
  FOREIGN KEY(FREIGHT_ESTIMATE_METHOD_KEY) REFERENCES DW.FREIGHT_ESTIMATE(FREIGHT_KEY),
  FOREIGN KEY(CARRIER_KEY) REFERENCES DW.CARRIER(CARRIER_KEY),
  FOREIGN KEY(REF_TRX_TYPE_KEY) REFERENCES DW.TRANSACTION_TYPE  (TRANSACTION_TYPE_KEY ),
  FOREIGN KEY(PO_STATUS_KEY) REFERENCES DW.TRANSACTION_STATUS (TRANSACTION_STATUS_KEY ),
  FOREIGN KEY(PO_TYPE_KEY) REFERENCES DW.TRANSACTION_TYPE (TRANSACTION_TYPE_KEY ),
  FOREIGN KEY(CURRENCY_KEY) REFERENCES DW.CURRENCIES   (CURRENCY_KEY))
DISTKEY(ITEM_KEY) INTERLEAVED SORTKEY (TRANSACTION_DATE_KEY,SUBSIDIARY_KEY,PO_TYPE_KEY,PO_NUMBER,PO_ID,PO_LINE_ID,DW_CURRENT);
