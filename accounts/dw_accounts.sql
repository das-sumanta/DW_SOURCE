CREATE SCHEMA if not exists dw;

DROP TABLE if exists dw.accounts;

CREATE TABLE dw.accounts 
(
  ACCOUNT_KEY             BIGINT IDENTITY(0,1),
  ACCOUNT_ID              INTEGER,
  NAME                    VARCHAR(200),
  ACCOUNTNUMBER           VARCHAR(60),
  ACCOUNT_EXTID           VARCHAR(255),
  ACCPAC_CODES            VARCHAR(4000),
  BANK_ACCOUNT_NUMBER     VARCHAR(4000),
  CASHFLOW_RATE_TYPE      VARCHAR(10),
  CLASS_ID                INTEGER,
  LINE_OF_BUSINESS        VARCHAR(100),
  CURRENCY_ID             INTEGER,
  CURRENCY_NAME           VARCHAR(200),
  DEFERRAL_ACCOUNT_ID     INTEGER,
  DEPARTMENT_ID           INTEGER,
  COST_CENTER_NAME        VARCHAR(100),
  DESCRIPTION             VARCHAR(25),
  GENERAL_RATE_TYPE       VARCHAR(10),
  HYPERION_CODES          VARCHAR(4000),
  ISINACTIVE              VARCHAR(10),
  LOCATION_ID             INTEGER,
  LOCATION_NAME           VARCHAR(100),
  PARENT_ID               INTEGER,
  PARENT_ACCOUNT_NAME     VARCHAR(200),
  PARENT_ACCOUNT_NUMBER   VARCHAR(60),
  DATE_ACTIVE_FROM        TIMESTAMP,
  DATE_ACTIVE_TO          TIMESTAMP,
  DW_ACTIVE               VARCHAR(1),
  PRIMARY KEY (ACCOUNT_KEY,ACCOUNT_ID,NAME)
)
DISTSTYLE ALL INTERLEAVED SORTKEY (ACCOUNT_KEY,ACCOUNT_ID,NAME,DW_ACTIVE);

INSERT INTO DW.ACCOUNTS
(
  ACCOUNT_ID,
  NAME,
  ACCOUNTNUMBER,
  ACCOUNT_EXTID,
  ACCPAC_CODES,
  BANK_ACCOUNT_NUMBER,
  CASHFLOW_RATE_TYPE,
  CLASS_ID,
  LINE_OF_BUSINESS,
  CURRENCY_ID,
  CURRENCY_NAME,
  DEFERRAL_ACCOUNT_ID,
  DEPARTMENT_ID,
  COST_CENTER_NAME,
  DESCRIPTION,
  GENERAL_RATE_TYPE,
  HYPERION_CODES,
  ISINACTIVE,
  LOCATION_ID,
  LOCATION_NAME,
  PARENT_ID,
  PARENT_ACCOUNT_NAME,
  PARENT_ACCOUNT_NUMBER,
  DATE_ACTIVE_FROM,
  DATE_ACTIVE_TO,
  DW_ACTIVE
)
SELECT -99 AS ACCOUNT_ID,
       'NA_GDW' AS NAME,
       'NA_GDW' AS ACCOUNTNUMBER,
       'NA_GDW' AS ACCOUNT_EXTID,
       'NA_GDW' AS ACCPAC_CODES,
       'NA_GDW' AS BANK_ACCOUNT_NUMBER,
       'NA_GDW' AS CASHFLOW_RATE_TYPE,
       -99 AS CLASS_ID,
       'NA_GDW' AS LINE_OF_BUSINESS,
       -99 AS CURRENCY_ID,
       'NA_GDW' AS CURRENCY_NAME,
       -99 AS DEFERRAL_ACCOUNT_ID,
       -99 AS DEPARTMENT_ID,
       'NA_GDW' AS COST_CENTER_NAME,
       'NA_GDW' AS DESCRIPTION,
       'NA_GDW' AS GENERAL_RATE_TYPE,
       'NA_GDW' AS HYPERION_CODES,
       'NA_GDW' AS ISINACTIVE,
       -99 AS LOCATION_ID,
       'NA_GDW' AS LOCATION_NAME,
       -99 AS PARENT_ID,
       'NA_GDW' AS PARENT_ACCOUNT_NAME,
       'NA_GDW' AS PARENT_ACCOUNT_NUMBER,
       sysdate AS DATE_ACTIVE_FROM,
       '9999-12-31 23:59:59' AS DATE_ACTIVE_TO,
       'A' AS DW_ACTIVE;

INSERT INTO DW.ACCOUNTS
(
  ACCOUNT_ID,
  NAME,
  ACCOUNTNUMBER,
  ACCOUNT_EXTID,
  ACCPAC_CODES,
  BANK_ACCOUNT_NUMBER,
  CASHFLOW_RATE_TYPE,
  CLASS_ID,
  LINE_OF_BUSINESS,
  CURRENCY_ID,
  CURRENCY_NAME,
  DEFERRAL_ACCOUNT_ID,
  DEPARTMENT_ID,
  COST_CENTER_NAME,
  DESCRIPTION,
  GENERAL_RATE_TYPE,
  HYPERION_CODES,
  ISINACTIVE,
  LOCATION_ID,
  LOCATION_NAME,
  PARENT_ID,
  PARENT_ACCOUNT_NAME,
  PARENT_ACCOUNT_NUMBER,
  DATE_ACTIVE_FROM,
  DATE_ACTIVE_TO,
  DW_ACTIVE
)
SELECT 0 AS ACCOUNT_ID,
       'NA_ERR' AS NAME,
       'NA_ERR' AS ACCOUNTNUMBER,
       'NA_ERR' AS ACCOUNT_EXTID,
       'NA_ERR' AS ACCPAC_CODES,
       'NA_ERR' AS BANK_ACCOUNT_NUMBER,
       'NA_ERR' AS CASHFLOW_RATE_TYPE,
       0 AS CLASS_ID,
       'NA_ERR' AS LINE_OF_BUSINESS,
       0 AS CURRENCY_ID,
       'NA_ERR' AS CURRENCY_NAME,
       0 AS DEFERRAL_ACCOUNT_ID,
       0 AS DEPARTMENT_ID,
       'NA_ERR' AS COST_CENTER_NAME,
       'NA_ERR' AS DESCRIPTION,
       'NA_ERR' AS GENERAL_RATE_TYPE,
       'NA_ERR' AS HYPERION_CODES,
       'NA_ERR' AS ISINACTIVE,
       0 AS LOCATION_ID,
       'NA_ERR' AS LOCATION_NAME,
       0 AS PARENT_ID,
       'NA_ERR' AS PARENT_ACCOUNT_NAME,
       'NA_ERR' AS PARENT_ACCOUNT_NUMBER,
       sysdate AS DATE_ACTIVE_FROM,
       '9999-12-31 23:59:59' AS DATE_ACTIVE_TO,
       'A' AS DW_ACTIVE;

COMMIT;
