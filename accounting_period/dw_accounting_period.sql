CREATE SCHEMA if not exists dw;

DROP TABLE if exists dw.accounting_period;

CREATE TABLE dw.accounting_period 
(
  ACCOUNTING_PERIOD_KEY   BIGINT IDENTITY(0,1),
  ACCOUNTING_PERIOD_ID    INTEGER,
  PERIOD_NAME             VARCHAR(300),
  START_DATE              TIMESTAMP,
  END_DATE                TIMESTAMP,
  FISCAL_CALENDAR         VARCHAR(100),
  SUBSIDIARY              VARCHAR(100),
  QUARTER_NAME            VARCHAR(300),
  YEAR_NAME               VARCHAR(300),
  CLOSED                  VARCHAR(10),
  CLOSED_AP               VARCHAR(10),
  CLOSED_AR               VARCHAR(10),
  CLOSED_PAYROLL          VARCHAR(10),
  CLOSED_ALL              VARCHAR(10),
  CLOSED_ON               TIMESTAMP,
  LOCKED_AP               VARCHAR(10),
  LOCKED_AR               VARCHAR(10),
  LOCKED_PAYROLL          VARCHAR(10),
  LOCKED_ALL              VARCHAR(10),
  ISINACTIVE              VARCHAR(10),
  DATE_ACTIVE_FROM        TIMESTAMP,
  DATE_ACTIVE_TO          TIMESTAMP,
  DW_ACTIVE               VARCHAR(1),
  PRIMARY KEY (ACCOUNTING_PERIOD_KEY,ACCOUNTING_PERIOD_ID)
)
DISTSTYLE ALL INTERLEAVED SORTKEY (ACCOUNTING_PERIOD_KEY,ACCOUNTING_PERIOD_ID,DW_ACTIVE);

INSERT INTO dw.accounting_period
(
  ACCOUNTING_PERIOD_ID,
  PERIOD_NAME,
  START_DATE,
  END_DATE,
  FISCAL_CALENDAR,
  SUBSIDIARY,
  QUARTER_NAME,
  YEAR_NAME,
  CLOSED,
  CLOSED_AP,
  CLOSED_AR,
  CLOSED_PAYROLL,
  CLOSED_ALL,
  CLOSED_ON,
  LOCKED_AP,
  LOCKED_AR,
  LOCKED_PAYROLL,
  LOCKED_ALL,
  ISINACTIVE,
  DATE_ACTIVE_FROM,
  DATE_ACTIVE_TO,
  DW_ACTIVE
)
SELECT -99 AS ACCOUNTING_PERIOD_ID,
       'NA_GDW' AS PERIOD_NAME,
       '1900-01-01 00:00:00' AS START_DATE,
       '1900-01-01 00:00:00' AS END_DATE,
       'NA_GDW' AS FISCAL_CALENDAR,
       'NA_GDW' AS SUBSIDIARY,
       'NA_GDW' AS QUARTER_NAME,
       'NA_GDW' AS YEAR_NAME,
       'NA_GDW' AS CLOSED,
       'NA_GDW' AS CLOSED_AP,
       'NA_GDW' AS CLOSED_AR,
       'NA_GDW' AS CLOSED_PAYROLL,
       'NA_GDW' AS CLOSED_ALL,
       '1900-01-01 00:00:00' AS CLOSED_ON,
       'NA_GDW' AS LOCKED_AP,
       'NA_GDW' AS LOCKED_AR,
       'NA_GDW' AS LOCKED_PAYROLL,
       'NA_GDW' AS LOCKED_ALL,
       'NA_GDW' AS ISINACTIVE,
       sysdate AS DATE_ACTIVE_FROM,
       '9999-12-31 23:59:59' AS DATE_ACTIVE_TO,
       'A' AS DW_ACTIVE;

INSERT INTO dw.accounting_period
(
  ACCOUNTING_PERIOD_ID,
  PERIOD_NAME,
  START_DATE,
  END_DATE,
  FISCAL_CALENDAR,
  SUBSIDIARY,
  QUARTER_NAME,
  YEAR_NAME,
  CLOSED,
  CLOSED_AP,
  CLOSED_AR,
  CLOSED_PAYROLL,
  CLOSED_ALL,
  CLOSED_ON,
  LOCKED_AP,
  LOCKED_AR,
  LOCKED_PAYROLL,
  LOCKED_ALL,
  ISINACTIVE,
  DATE_ACTIVE_FROM,
  DATE_ACTIVE_TO,
  DW_ACTIVE
)
SELECT 0 AS ACCOUNTING_PERIOD_ID,
       'NA_ERR' AS PERIOD_NAME,
       '1900-01-01 00:00:00' AS START_DATE,
       '1900-01-01 00:00:00' AS END_DATE,
       'NA_ERR' AS FISCAL_CALENDAR,
       'NA_ERR' AS SUBSIDIARY,
       'NA_ERR' AS QUARTER_NAME,
       'NA_ERR' AS YEAR_NAME,
       'NA_ERR' AS CLOSED,
       'NA_ERR' AS CLOSED_AP,
       'NA_ERR' AS CLOSED_AR,
       'NA_ERR' AS CLOSED_PAYROLL,
       'NA_ERR' AS CLOSED_ALL,
       '1900-01-01 00:00:00' AS CLOSED_ON,
       'NA_ERR' AS LOCKED_AP,
       'NA_ERR' AS LOCKED_AR,
       'NA_ERR' AS LOCKED_PAYROLL,
       'NA_ERR' AS LOCKED_ALL,
       'NA_ERR' AS ISINACTIVE,
       sysdate AS DATE_ACTIVE_FROM,
       '9999-12-31 23:59:59' AS DATE_ACTIVE_TO,
       'A' AS DW_ACTIVE;

