CREATE SCHEMA if not exists dw_prestage;

DROP TABLE if exists dw_prestage.vb_fact;

CREATE TABLE dw_prestage.vb_fact 
(
  RUNID                   INTEGER,
  TRANSACTION_ID          INTEGER,
  VB_NUMBER               VARCHAR(200),
  TRANSACTION_LINE_ID     INTEGER,
  VENDOR_ID               INTEGER,
  CREATED_FROM_ID         INTEGER,
  REF_TRX_NUMBER          VARCHAR(200),
  REF_TRX_TYPE            VARCHAR(200),
  EXT_REF_NUMBER          VARCHAR(200),
  account_name            VARCHAR(2000),
  account_number          VARCHAR(60),
  PAYMENT_TERMS_ID        INTEGER,
  payment_hold            VARCHAR(10),
  vb_due_date             TIMESTAMP,
  gl_post_date            TIMESTAMP,
  vendor_bill_date        TIMESTAMP,
  CREATED_BY_ID           INTEGER,
  APPROVER_LEVEL_ONE_ID   INTEGER,
  APPROVER_LEVEL_TWO_ID   INTEGER,
  REQUESTOR_ID            INTEGER,
  CREATE_DATE             TIMESTAMP,
  SUBSIDIARY_ID           INTEGER,
  DEPARTMENT_ID           INTEGER,
  ITEM_ID                 INTEGER,
  LOCATION_ID             INTEGER,
  EXCHANGE_RATE           DECIMAL(30,15),
  VENDOR_ADDRESS_LINE_1   VARCHAR(200),
  VENDOR_ADDRESS_LINE_2   VARCHAR(200),
  VENDOR_ADDRESS_LINE_3   VARCHAR(200),
  VENDOR_CITY             VARCHAR(100),
  VENDOR_COUNTRY          VARCHAR(100),
  VENDOR_STATE            VARCHAR(100),
  VENDOR_ZIP              VARCHAR(50),
  VB_STATUS               VARCHAR(500),
  APPROVAL_STATUS         VARCHAR(4000),
  ITEM_COUNT              DECIMAL(18,8),
  ITEM_GROSS_AMOUNT       DECIMAL(18,8),
  AMOUNT                  DECIMAL(22,2),
  AMOUNT_FOREIGN          DECIMAL(22,2),
  NET_AMOUNT              DECIMAL(22,2),
  NET_AMOUNT_FOREIGN      DECIMAL(22,2),
  GROSS_AMOUNT            DECIMAL(22,2),
  ITEM_UNIT_PRICE         VARCHAR(42),
  CLOSE_DATE              TIMESTAMP,
  TAX_ITEM_ID             INTEGER,
  TRANSACTION_ORDER       INTEGER,
  TAX_AMOUNT              DECIMAL(20,2),
  TAX_AMOUNT_FOREIGN      DECIMAL(22,2),
  VB_TYPE                 VARCHAR(4000),
  CURRENCY_ID             INTEGER,
  CUSTOM_FORM_ID          INTEGER,
  DATE_LAST_MODIFIED      TIMESTAMP,
  EMPLOYEE_CUSTOM_ID      INTEGER,
  CLASS_ID                INTEGER,
  LINE_TYPE               VARCHAR(500),
  MATCH_EXCEPTION         VARCHAR(10),
  EXCEPTION_MESSAGE       VARCHAR(4000),
  PRIMARY KEY (TRANSACTION_ID,TRANSACTION_LINE_ID))
DISTKEY(ITEM_ID) INTERLEAVED SORTKEY (TRANSACTION_ID,TRANSACTION_LINE_ID);

